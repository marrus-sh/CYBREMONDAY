{% assign ext = page.path | split: "." | last %}{% assign names = include.name | split: "|" %}{% assign teitag = names[0] %}{% assign tag = teitag %}{% assign mapping = site.data.tags[tag] %}{% if ext != "tei" %}{% if names.size > 1 %}{% assign tag = names | shift | join: "|" %}{% else %}{% assign tag = mapping.html | default: "SPAN" %}{% endif %}{% endif %}{% assign void = false %}{% if include.n or mapping.void %}{% assign void = true %}{% endif %}{% assign attrs = include.a | default: "`" | split: "`" %}{% if include.h and ext != "tei" %}{% assign hatts = include.h | split: "`" %}{% else %}{% assign hatts = nil %}{% endif %}{% if include.open %}<{{ tag }}{% unless ext == "tei" %} Class={% include attr value=teitag %}{% assign role = include.role | default: mapping.role %}{% if role %} role={% include attr value=role %}{% endif %}{% for attr in hatts %}{% assign a = attr | split: "=" %}{% if a[0].size > 0 %} {{ a[0] }}{% if a[1] %}{% assign value = a | shift | join: "=" %}={% include attr value=value %}{% endif %}{% endif %}{% endfor %}{% endunless %}{% for attr in attrs %}{% assign a = attr | split: "=" %}{% if a[0].size > 0 %} {% if ext == "tei" %}{{ a[0] }}{% else %}{% assign tname = a[0] %}{% assign aname = mapping.attrs[tname] %}{% unless aname %}{% assign aname = site.data.tags["*"].attrs[tname] %}{% endunless %}{% if aname %}{{ aname }}{% else %}{{ a[0] | capitalize | prepend: "Data-" }}{% endif %}{% endif %}{% if a[1] %}{% assign value = a | shift | join: "=" %}={% include attr value=value %}{% elsif ext == "tei" %}=""{% endif %}{% endif %}{% endfor %}{% if include.close or void %}{% if ext == "tei" %} /{% endif %}{% endif %}>{% endif %}{% if include.close %}{% unless ext == "tei" or void %}</{{ tag }}>{% endunless %}{% endif %}
{%- comment %}[Strip whitespace]{% endcomment -%}
